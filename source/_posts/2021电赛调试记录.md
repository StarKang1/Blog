---
title: 2021电赛调试记录
tags:
  - 电赛
  - 笔记
categories: 笔记
abbrlink: 29673
date: 2022-02-11 01:08:19
cover: https://picsum.photos/id/371/300/300
---
三相逆变调板记录2021-8-4

1.修改了scope触发通道到第1通道，触发值改大，确保稳定触发看RAM波形。改scope.prescaler值分辨RAM波形是否在刷新。

2.示波器有50欧内阻那组，接到逆变三相负载电阻会导致三相不平衡，示波器要切到1M欧内阻

3.AD采样绝对偏移要用软件大低通滤波校正。后续电流采样也要如此校正

4.大调制比0.95时A相波峰有失真现象，交换相IR2110模块后依旧，怀疑是MOS板问题，用换相法锁定问题位置，信号板、MOS板、IR2110板、电阻板、LC板这5个中的哪一个。

5.clarke输出alpha,beta取模后，有低频脉动，主要是谐波或三相不对称引起，说明不大适用于反馈闭环，建议用一相的线电压有效值做为反馈闭环控制，展示测量时，要注意用算有效值的那个线电压进行展示测量。
用于闭环的反馈线电压要做好深度滤波从而只让基波50Hz进入闭环反馈。有效值脉动大小还有待观测。

6.改SVPWM后，实验电压提高了15%，电阻端相电压看不到马鞍波形，马鞍波形含有3次谐波被差分掉了，如果是相对逆变器地估计能看到马鞍波形

7.后续可以提高开关频率或优化死区或优化LC参数，改善失真。提高开关频率时，要注意中断服务函数不要超过开关周期。

8.要理顺功率板、信号板、换载板的ABC相序对应关系，做好标记。


三相逆变调板记录2021.08.07

1.IRF540耐压值100V，在母线电压升至60V，IR2110模块使用20欧驱动电阻尖峰值有可能将其击穿,后续可以替换成IRF640（耐压200V）

2.电压通过运放的电压跟随器有可能触底，这时候可以采用去除运放，将电压分压并在其输出端接一个反向二极管接入采用口

3.软件很经常会出现问题，需要及时备份

4.功率板布线不合理有可能导致测量时出现的尖峰

5.负载模块带重载的滤波效果可能会比带轻载好

6.较高电压的线尽量远离较低电压的线，避免出现通信异常

7.IR2110模块驱动电阻为20欧姆时，上升沿时间大概为0.2us，当其为47欧姆时，上升沿时间大概为0.5us

8.软件示波器有可能出现错误，这时候先排查硬件问题，再重启软件

9.在比赛期间测试波形时，尽量测试差分信号，放大为1-2个周期观察波形

10.将开关频率从16K改成32K时要记得测试中断时间是否够

11.调试过程中发现电流不正常立马断电检查电路，以免烧板

12.去掉运放之后的采样电压还未达到饱和，波形就开始失真了

2021.11.1调试记录

1.CSD19535寄生电容大约是IRF640的三倍，因此在同样的RC时间常数情况下，CSD19535需要的驱动电阻大约只需要IRF640的三分之一

2.RC吸收电路：在MOS管关闭时，C吸收尖峰能量，同时R来消耗，C的大小决定了吸收的大小，如果C过大，意味着R需要消耗的功率也就越大
这需要就需要确定合适的RC参数，RC 参数乘积大概在导通时间的三分之一到五分之一，假设，我们选取0.5us的死区时间，那么RC=0.1us，
如果选取R=100欧，那么需要的电容就等于102.

3.关于示波器问题，使用不同的表笔就出来的波形也有点不一样，这就不清楚哪个是真的了

4.IRF640在带母线测试时，波形的上升沿和上升沿近似相同，上升时间和下降时间也相同，采用IRF640可能是比较好的方案（前提示波器没有问题）

5.硬件部分，优化了布线，MOS管环路面积要小，VCC-GND-LS，使用RC吸收电路吸收尖峰（尖峰大小也和环路面积有关）

6.下一步计划：重做信号板，重做功率板，滤波参数确定以及滤波板的重新设计
2021.11.2调试记录
1.IRF640选择100欧驱动电阻，去掉二极管，加RC吸收尖峰，出来的方波正常

2021.11.05调试记录

1.新增了电压电流保护，触发pwm关闭
2.新增了电流采样，电流滤波
3.关于软件的克拉克变换与派克变换验证相位正常

2021.11.06调试记录

1.滤波板方向方向导致电流过大，MOS管发热严重
2.pwm整流输出稳压方向：三相逆变电流闭环，在完成闭环后，将三相交流电从从负载接入端接入，再将pi给定电流转换为-Id，
以及将给定相位用相电压相位替代，这就完成了PWM整流加电流闭环
3.在做电流采样板时要注意分压电阻大小以及误差
4.霍尔传感器中间绕线，中间电流1A，走线电流为1/3A
5.采样电流实际值与标幺值之比为8:1；
6.软件调试，上升沿观察-将cnt改为大于0触发，下降沿观察-将cnt改为大于1小于128触发
7.AD校正-将占空比给0，观察电压与0点的差值，并将波形校正至零点
8.电流校正：将学生电源设置为恒流模式，将导线穿过霍尔传感器，采样电流转换为实际电流的1/3；

2021.11.11反思

比赛结束了
闭环时电压还是掉下来了
没有办法，我想可能还是LC参数不匹配
当时成功的那一次刚好有1000u的电容，电压上去了，闭环也成功了，这就说明代码没有问题
我太慌乱了，我很抱歉，这一点没有想到
如果当时可以想到这一点就好了

2021.12.01总结

在比赛结束后，终于实现了电压可调，只是调的范围不大，pi_udc的输出需要限幅，不然会导致输出母线电压过大或者电流过大
功率因数也可实现0.92调节至0.99，转换效率暂且还没看，但是基本功能应该是完成了

2022.03.30

时隔多日，我又开始回顾了一遍当时做的实验，发现都忘记的差不多了，工科可能就是这样，需要不断的去积累经验，做好笔记，才真正有可能学到东西，当发现一件事情比较麻烦，也不要逃避，就大胆去做，就像我当时去参加电赛一样，本来什么都不会，但是在比赛过程中，我才发现完完整整去做一个项目是需要花费时间的，也是非常困难的，这就需要我们不断去试错，不断去改错，结果或许是重要的，但对于我来说，过程比结果更重要。
